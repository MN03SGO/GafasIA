import subprocess
import sys
import importlib.util

def check_module(module):
    spec = importlib.util.find_spec(module)
    return spec is not None

def check_tesseract():
    try:
        result = subprocess.run(['tesseract', '-v'], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
        return result.returncode == 0
    except FileNotFoundError:
        return False

def check_camera():
    try:
        import cv2
        cam = cv2.VideoCapture(0)
        ret, frame = cam.read()
        cam.release()
        return ret
    except Exception:
        return False

def check_tts():
    try:
        import pyttsx3
        engine = pyttsx3.init()
        engine.say("Hola, esto es una prueba de voz en tu Raspberry Pi.")
        engine.runAndWait()
        return True
    except Exception:
        return False

def main():
    print("\nğŸ” Verificando entorno para Gafas IA â€” by Sigaran...\n")

    print("âœ… Python 3.x:", sys.version)

    modules = {
        "cv2 (OpenCV)": "cv2",
        "pytesseract": "pytesseract",
        "torch": "torch",
        "pyttsx3": "pyttsx3"
    }

    for name, module in modules.items():
        print(f"{'âœ…' if check_module(module) else 'âŒ'} {name}")

    print(f"{'âœ…' if check_tesseract() else 'âŒ'} Tesseract OCR instalado")
    print(f"{'âœ…' if check_camera() else 'âŒ'} CÃ¡mara funcional")
    print(f"{'âœ…' if check_tts() else 'âŒ'} TTS funcionando con pyttsx3")

    print("\nğŸ¯ Si todo aparece con âœ…, tu Raspberry estÃ¡ lista para el proyecto.\n")

if __name__ == "__main__":
    main()